var oddin=angular.module("oddin",["ui.router","ui.materialize","ngCookies","ui.mask"]);oddin.config(["$stateProvider",function(t){t.state("login",{url:"/login",templateUrl:"/partials/login",controller:"LoginController"}).state("recuperar_senha",{url:"/recuperar_senha",templateUrl:"/partials/recover-password",controller:"LoginController"}).state("redefinir_senha",{url:"/redefinir_senha",templateUrl:"/partials/redefine-password",controller:"LoginController"}).state("instructions",{url:"/disciplinas",templateUrl:"/partials/instructions",controller:"InstructionsController"}).state("presentations",{url:"/disciplinas/:instructionID/aulas",templateProvider:function(t,e){return 0==t.get("profile")?e.fromUrl("/partials/presentations-a"):1==t.get("profile")?e.fromUrl("/partials/presentations-p"):void 0},controller:"PresentationsController"}).state("avisos",{url:"/disciplinas/:disciplinaID/avisos",templateProvider:function(t,e){return 0==t.get("profile")?e.fromUrl("/partials/avisos-a"):1==t.get("profile")?e.fromUrl("/partials/avisos-p"):void 0},controller:"NoticesController"}).state("datas",{url:"/disciplinas/:disciplinaID/datas",templateProvider:function(t,e){return 0==t.get("profile")?e.fromUrl("/partials/datas-a"):1==t.get("profile")?e.fromUrl("/partials/datas-p"):void 0},controller:"DatesController"}).state("tarefas",{url:"/disciplinas/:disciplinaID/tarefas",templateProvider:function(t,e){return 0==t.get("profile")?e.fromUrl("/partials/tarefas-a"):1==t.get("profile")?e.fromUrl("/partials/tarefas-p"):void 0},controller:"WorksController"}).state("materiais",{url:"/disciplinas/:disciplinaID/materiais",templateProvider:function(t,e){return 0==t.get("profile")?e.fromUrl("/partials/materiais-a"):1==t.get("profile")?e.fromUrl("/partials/materiais-p"):void 0},controller:"MaterialsController"}).state("participantes",{url:"/disciplinas/:disciplinaID/participantes",templateUrl:"/partials/participantes",controller:"ParticipantsController"}).state("faqs",{url:"/disciplinas/:disciplinaID/faqs",templateProvider:function(t,e){return 0==t.get("profile")?e.fromUrl("/partials/faqs-a"):1==t.get("profile")?e.fromUrl("/partials/faqs-p"):void 0},controller:"FAQsController"}).state("enquetes",{url:"/disciplinas/:disciplinaID/enquetes",templateProvider:function(t,e){return 0==t.get("profile")?e.fromUrl("/partials/enquetes-a"):1==t.get("profile")?e.fromUrl("/partials/enquetes-p"):void 0},controller:"SurveysController"}).state("duvidas",{url:"/aulas/:aulaID",templateProvider:function(t,e){return 0==t.get("profile")?e.fromUrl("/partials/duvidas-a"):1==t.get("profile")?e.fromUrl("/partials/duvidas-p"):void 0},controller:"PresentationShowController"}).state("material-aula",{url:"/aulas/:aulaID/material",templateProvider:function(t,e){return 0==t.get("profile")?e.fromUrl("/partials/material-aula-a"):1==t.get("profile")?e.fromUrl("/partials/material-aula-p"):void 0},controller:"PresentationMaterialController"}).state("tarefa-status",{url:"/tarefas/:tarefaID",templateProvider:function(t,e){return 0==t.get("profile")?e.fromUrl("/partials/tarefa-status-a"):1==t.get("profile")?e.fromUrl("/partials/tarefa-status-p"):void 0},controller:"WorkShowController"}).state("admin-events",{url:"/admin-cursos",templateUrl:"/partials/admin/events",controller:"AdminEventsController"}).state("admin-lectures",{url:"/admin-disciplinas",templateUrl:"/partials/admin/lectures",controller:"AdminLecturesController"}).state("admin-users",{url:"/admin-usuarios",templateUrl:"/partials/admin/users",controller:"AdminUsersController"}).state("admin-event-show",{url:"/admin-cursos/:eventID",templateUrl:"/partials/admin/event-show",controller:"AdminEventShowController"}).state("admin-instruction-show",{url:"/admin-disciplinas-cadastradas/:instructionID",templateUrl:"/partials/admin/instruction-show",controller:"AdminInstructionShowController"}).state("admin-add-participants",{url:"/add-participants/:instructionID",templateUrl:"/partials/admin/add-participants",controller:"AdminInstructionShowController"}).state("admin-add-instructions",{url:"/add-instructions/:eventID",templateUrl:"/partials/admin/add-instructions",controller:"AdminEventShowController"})}]).run(["$window","$location","$state","$cookies",function(t,e,a,n){"/home"==t.location.pathname&&(n.get("admin")?a.go("admin-events"):a.go("instructions")),"/"==t.location.pathname&&(n.get("session")?t.location.href="/home":a.go("login"))}]),oddin.controller("AdminEventsController",["$scope","EventAPI","CurrentUser","ManageList",function(t,e,a,n){t.user=a,function(){t.load=!1,e.index().then(function(e){t.events=e.data}).catch(function(){Materialize.toast("Erro ao carregar cursos",3e3)}).finally(function(){t.load=!0})}(),t.createEvent=function(a){t.load=!1,e.create(a).then(function(e){t.events.push(e.data),Materialize.toast("Curso cadastrado",3e3)}).catch(function(){Materialize.toast("Erro ao cadastrar curso",3e3)}).finally(function(){delete t.newEvent,t.load=!0})},t.updateEvent=function(a){t.load=!1,e.update(a.id,a).then(function(e){n.updateItem(t.events,e.data),Materialize.toast("Curso atualizado",3e3)}).catch(function(){Materialize.toast("Erro ao atualizar curso",3e3)}).finally(function(){t.load=!0})},t.deleteEvent=function(a){t.load=!1,e.destroy(a.id).then(function(e){n.deleteItem(t.events,a),Materialize.toast("Curso deletado",3e3)}).catch(function(){Materialize.toast("Erro ao excluir curso",3e3)}).finally(function(){t.load=!0})},t.modalEdit=function(e){t.modalEvent=angular.copy(e),$("#modal-edit").openModal()},t.modalDelete=function(e){t.modalEvent=angular.copy(e),$("#modal-delete").openModal()}}]),oddin.controller("AdminEventShowController",["$scope","$stateParams","CurrentUser","InstructionAPI","EventAPI","LectureAPI","$filter","ManageList",function(t,e,a,n,o,i,r,s){function d(t){var e=r("date")(t.start_date,"yyyy"),a=r("date")(t.start_date,"MM")<7?1:2,n=e+"/"+a;t.season=n}t.user=a,function(){t.load=!1,o.show(e.eventID).then(function(e){t.event=e.data}).catch(function(){Materialize.toast("Erro ao carregar informações do curso",3e3)}).finally(function(){t.load=!0})}(),function(){t.load=!1,o.getInstructions(e.eventID).then(function(e){t.instructions=e.data,t.instructions.forEach(function(t){d(t)})}).catch(function(){Materialize.toast("Erro ao carregar disciplinas cadastradas",3e3)}).finally(function(){t.load=!0})}(),t.findLectures=function(){t.load=!1,i.index().then(function(e){t.lectures=e.data}).catch(function(){Materialize.toast("Erro ao carregar disciplinas disponíveis",3e3)}).finally(function(){t.load=!0})},t.createInstruction=function(a){t.load=!1,a.lecture=a.lecture.id,a.event=e.eventID,a.start_date=r("toDate")(a.start_date),a.end_date=r("toDate")(a.end_date),n.create(a).then(function(e){d(e.data),t.instructions.push(e.data),Materialize.toast("Disciplina Adicionada",3e3)}).catch(function(){Materialize.toast("Erro ao adicionar disciplina",3e3)}).finally(function(){t.load=!0})},t.deleteInstruction=function(e){t.load=!1,n.destroy(e.id).then(function(a){s.deleteItem(t.instructions,e),Materialize.toast("Disciplina removida",3e3)}).catch(function(){Materialize.toast("Erro ao remover disciplina",3e3)}).finally(function(){t.load=!0})},t.modalAdd=function(e){t.modalInstruction={},t.modalInstruction.lecture=angular.copy(e),$("#modal-add").openModal()},t.modalRemove=function(e){t.modalInstruction=angular.copy(e),$("#modal-remove").openModal()}}]),oddin.controller("AdminInstructionShowController",["$scope","$stateParams","CurrentUser","InstructionAPI","PersonAPI","EnrollAPI","ManageList",function(t,e,a,n,o,i,r){t.user=a,function(){n.show(e.instructionID).then(function(e){t.instruction=e.data}).catch(function(){Materialize.toast("Erro ao carregar informações da disciplina",3e3)})}(),t.findParticipants=function(){t.load=!1,n.getParticipants(e.instructionID).then(function(e){t.participants=e.data}).catch(function(){Materialize.toast("Erro ao carregar participantes da disciplina",3e3)}).finally(function(){t.load=!0})},t.findAvailableParticipants=function(){t.load=!1,o.index().then(function(a){return t.registeredUsers=a.data,n.getParticipants(e.instructionID)}).then(function(e){t.participants=e.data,t.availableUsers=t.registeredUsers.filter(function(e,a){var n=t.participants.findIndex(function(t){return t.person.id==e.id});if(n<0)return!0})}).catch(function(){Materialize.toast("Erro ao carregar usuários cadastrados",3e3)}).finally(function(){t.load=!0})},t.createEnroll=function(a){t.load=!1;var n={person_id:a.id,instruction_id:e.instructionID,profile:a.enrollProfile?1:0};i.create(n).then(function(e){t.participants.push(e.data),r.deleteItem(t.availableUsers,e.data.person),Materialize.toast("Usuário cadastrado",3e3)}).catch(function(){Materialize.toast("Erro ao adicionar usuário",3e3)}).finally(function(){t.load=!0})},t.deleteEnroll=function(e){t.load=!1,i.destroy(e.id).then(function(a){r.deleteItem(t.participants,e),t.availableUsers&&t.availableUsers.push(e.person),Materialize.toast("Usuário removido",3e3)}).catch(function(){Materialize.toast("Erro ao remover usuário",3e3)}).finally(function(){t.load=!0})},t.modalRemove=function(e){t.modalParticipant=angular.copy(e),$("#modal-remove").openModal()}}]),oddin.controller("AdminLecturesController",["$scope","CurrentUser","LectureAPI","ManageList",function(t,e,a,n){t.user=e,function(){t.load=!1,a.index().then(function(e){t.lectures=e.data}).catch(function(){Materialize.toast("Erro ao carregar disciplinas",3e3)}).finally(function(){t.load=!0})}(),t.createLecture=function(e){t.load=!1,a.create(e).then(function(e){t.lectures.push(e.data),Materialize.toast("Disciplina cadastrada",3e3)}).catch(function(){Materialize.toast("Erro ao cadastrar disciplina",3e3)}).finally(function(){delete t.newLecture,t.load=!0})},t.updateLecture=function(e){t.load=!1,a.update(e.id,e).then(function(e){n.updateItem(t.lectures,e.data),Materialize.toast("Disciplina atualizada",3e3)}).catch(function(){Materialize.toast("Erro ao atualizar disciplina",3e3)}).finally(function(){t.load=!0})},t.deleteLecture=function(e){t.load=!1,a.destroy(e.id).then(function(a){n.deleteItem(t.lectures,e),Materialize.toast("Disciplina deletada",3e3)}).catch(function(){Materialize.toast("Erro ao excluir disciplina",3e3)}).finally(function(){t.load=!0})},t.modalEdit=function(e){t.modalLecture=angular.copy(e),$("#modal-edit").openModal()},t.modalDelete=function(e){t.modalLecture=angular.copy(e),$("#modal-delete").openModal()}}]),oddin.controller("AdminUsersController",["$scope","CurrentUser","PersonAPI","ManageList",function(t,e,a,n){t.user=e,function(){t.load=!1,a.index().then(function(e){t.users=e.data}).catch(function(){Materialize.toast("Erro ao carregar usuários",3e3)}).finally(function(){t.load=!0})}(),t.createUser=function(e){t.load=!1,a.create(e).then(function(e){t.users.push(e.data),Materialize.toast("Usuário cadastrado",3e3)}).catch(function(){Materialize.toast("Erro ao cadastrar usuário",3e3)}).finally(function(){delete t.newUser,t.load=!0})},t.updateUser=function(e){t.load=!1,a.update(e.id,e).then(function(e){n.updateItem(t.users,e.data),Materialize.toast("Usuário atualizado",3e3)}).catch(function(){Materialize.toast("Erro ao atualizar usuário",3e3)}).finally(function(){t.load=!0})},t.deleteUser=function(e){t.load=!1,a.destroy(e.id).then(function(a){n.deleteItem(t.users,e),Materialize.toast("Usuário excluído",3e3)}).catch(function(){Materialize.toast("Erro ao excluir usuário",3e3)}).finally(function(){t.load=!0})},t.modalEdit=function(e){t.modalUser=angular.copy(e),$("#modal-edit").openModal()},t.modalDelete=function(e){t.modalUser=angular.copy(e),$("#modal-delete").openModal()}}]),oddin.controller("DatesController",["$scope","$stateParams","DateAPI","InstructionAPI","CurrentUser","$filter",function(t,e,a,n,o,i){function r(){n.show(e.disciplinaID).then(function(e){t.disciplina=e.data}).catch(function(t){console.log(t.data)})}t.usuario=o,t.data_loaded=!0,t.postaData=function(a){t.data_loaded=!1;var o=angular.copy(a);o.date=i("toDate")(o.date,o.time),delete o.time,delete t.date,n.createDate(e.disciplinaID,o).then(function(e){t.datas.push(e.data),t.data_loaded=!0,Materialize.toast("A Data foi postada",4e3)}).catch(function(t){console.log(t.data)})},t.buscaDatas=function(){n.getDates(e.disciplinaID).then(function(e){t.datas=e.data}).catch(function(t){console.log(t.data)})},t.updateDate=function(e){t.data_loaded=!1;var n=angular.copy(e);n.date=i("toDate")(n.date,n.time),delete n.time,delete t.modalContent,a.update(n.id,n).then(function(e){for(var a=0;a<t.datas.length;a++)if(t.datas[a].id==e.data.id){t.datas[a]=e.data;break}t.data_loaded=!0,Materialize.toast("Data atualizada",3e3)}).catch(function(t){console.log(t.data)})},t.deleteDate=function(e){t.data_loaded=!1;var n=angular.copy(e);delete t.modalContent,a.destroy(n.id).then(function(e){for(var a=0;a<t.datas.length;a++)if(t.datas[a].id==n.id){t.datas.splice(a,1);break}t.data_loaded=!0}).catch(function(t){console.log(t.data)})},t.openModalDeleteDate=function(e){t.modalContent=e,$("#modal-delete-date").openModal()},t.openModalEditDate=function(e){var a=e.date;t.modalContent=angular.copy(e),t.modalContent.date=i("date")(a,"ddMMyyyy"),t.modalContent.time=i("date")(a,"HHmm"),$("#modal-editar-data").openModal()},r()}]),oddin.controller("FAQsController",["$scope","$stateParams","InstructionAPI","FaqAPI","CurrentUser",function(t,e,a,n,o){t.usuario=o,t.data_loaded=!0,function(){a.show(e.disciplinaID).then(function(e){t.disciplina=e.data}).catch(function(t){console.log(t.data)})}(),t.buscaFAQs=function(){a.getFAQs(e.disciplinaID).then(function(e){t.faqs=e.data}).catch(function(t){console.log(t.data)})},t.createFAQ=function(n){t.data_loaded=!1;var o=angular.copy(n);delete t.faq,a.createFAQ(e.disciplinaID,o).then(function(e){t.faqs.push(e.data),t.data_loaded=!0,Materialize.toast("FAQ postada com sucesso",3e3)}).catch(function(t){console.log(t.data)})},t.updateFAQ=function(e){t.data_loaded=!1;var a=angular.copy(e);delete t.modalContent,n.update(a.id,a).then(function(e){for(var a=0;a<t.faqs.length;a++)if(t.faqs[a].id==e.data.id){t.faqs[a]=e.data;break}t.data_loaded=!0,Materialize.toast("FAQ atualizada com sucesso",3e3)}).catch(function(t){console.log(t.data)})},t.deleteFAQ=function(e){t.data_loaded=!1,n.destroy(e.id).then(function(e){for(var a=0;a<t.faqs.length;a++)if(t.faqs[a].id==e.data.id){t.faqs.splice(a,1);break}t.data_loaded=!0,Materialize.toast("FAQ excluída com sucesso",3e3)}).catch(function(t){console.log(t.data)})},t.displayAnswer=function(t){"none"==$("#answer-"+t.id).css("display")?$("#answer-"+t.id).css("display","block"):$("#answer-"+t.id).css("display","none")},t.displayButton=function(t){return"none"==$("#answer-"+t.id).css("display")?"Ver Resposta":"Ocultar Resposta"},t.openModalEditFAQ=function(e){t.modalContent=angular.copy(e),$("#edit-faq").openModal()},t.openModalDeleteFAQ=function(e){t.modalContent=angular.copy(e),$("#delete-faq").openModal()}}]),oddin.controller("InstructionsController",["$scope","$cookies","$state","CurrentUser","InstructionAPI","$filter",function(t,e,a,n,o,i){function r(e){var a={};t.seasons=e.map(function(t){var e=i("date")(t.start_date,"MM")<7?1:2,n=i("date")(t.start_date,"yyyy"),o=n+"/"+e;if(!a.hasOwnProperty(o))return a[o]=!0,{label:o,instructions:[]}}).filter(function(t){return"undefined"!=typeof t}),t.seasons.forEach(function(t){e.forEach(function(e){var a=i("date")(e.start_date,"yyyy");a+="/"+(i("date")(e.start_date,"MM")<7?1:2),t.label==a&&t.instructions.push(e)})})}t.user=n,function(){t.load=!1,o.index().then(function(t){r(t.data)}).catch(function(t){Materialize.toast("Erro ao carregar disciplinas",3e3)}).finally(function(){t.load=!0})}(),t.enterInstruction=function(t){e.get("profile")?a.go("presentations",{instructionID:t.id}):o.getProfile(t.id).then(function(n){e.put("profile",n.data.profile),a.go("presentations",{instructionID:t.id})}).catch(function(){Materialize.toast("Erro ao tentar entrar em "+t.lecture.name,3e3)})}}]),oddin.controller("LoginController",["$scope","$window","LoginAPI","$cookies","$location","$state",function(t,e,a,n,o,i){t.load=!0,t.login=function(o){t.load=!1,a.login(o).then(function(t){if(o.persist){var a=new Date;a.setMonth(a.getMonth()+1),n.put("session",n.get("session"),{expires:a})}t.data.person.admin&&n.put("admin",!0),e.location.href="/home"}).catch(function(t){401==t.status&&Materialize.toast("Usuário ou senha inválida",3e3),t.status>=500&&Materialize.toast("Erro no servidor",3e3)}).finally(function(){t.load=!0,delete t.user})},t.logout=function(){a.logout().then(function(){n.remove("session"),n.remove("profile"),n.remove("admin"),e.location.href="/"}).catch(function(){Materialize.toast("Não foi possível sair da aplicação")})},t.recoverPassword=function(e){t.load=!1,a.recoverPassword(e).then(function(){Materialize.toast("Um Email com o link para recuperação de senha será enviado para "+e.email,3e3),i.go("login")}).catch(function(){Materialize.toast("Não foi possível enviar o email de recuperação de senha",3e3)}).finally(function(){t.load=!0,delete t.user})},t.redefinePassword=function(e){return t.load=!1,e.password!==e.passwordConfirmation?(t.load=!0,delete t.user,void Materialize.toast("As senhas estão diferentes",3e3)):(e.token=o.search().token,void a.redefinePassword(e).then(function(){Materialize.toast("Senha redefinida com sucesso",3e3),i.go("login")}).catch(function(){Materialize.toast("Erro ao redefinir senha",3e3)}).finally(function(){t.load=!0,delete t.user}))}}]),oddin.controller("MaterialsController",["$http","$scope","$stateParams","InstructionAPI","MaterialAPI","CurrentUser",function(t,e,a,n,o,i){function r(){n.show(a.disciplinaID).then(function(t){e.disciplina=t.data}).catch(function(t){console.log(t.data)})}function s(e){newMaterial=e.data,file=document.forms.uploadArchive.file.files[0],fd=new FormData;for(var a in newMaterial.fields)fd.append(a,newMaterial.fields[a]);return fd.append("file",file),t.post(newMaterial.url,fd,{headers:{"Content-Type":void 0}})}function d(){return o.update(newMaterial.id,{name:file.name,mime:file.type})}function l(t){e.materiais.push(t.data.material),e.data_loaded=!0,document.getElementById("material-file").value="",document.getElementById("material-description").value="",Materialize.toast("O arquivo "+file.name+" foi postado",3e3)}e.usuario=i,e.data_loaded=!0,e.buscaMateriais=function(){n.getMaterials(a.disciplinaID).then(function(t){e.materiais=t.data}).catch(function(t){console.log(t.data)})},e.uploadMaterial=function(){e.data_loaded=!1,n.createMaterial(a.disciplinaID).then(s).then(d).then(l).catch(function(t){console.log(t.data)})},e.downloadMaterial=function(t){e.data_loaded=!1,o.show(t.id).then(function(a){var n=document.createElement("a");n.setAttribute("href",a.data.url),n.setAttribute("download",!0),hiddenLink=document.getElementById("hidden-link"),hiddenLink.appendChild(n),n.click(),e.data_loaded=!0,Materialize.toast("Fazendo download de "+t.name,4e3),hiddenLink.removeChild(n)}).catch(function(t){console.log(t.data)})},e.deleteMaterial=function(t){e.data_loaded=!1,o.destroy(t.id).then(function(a){for(var n=0;n<e.materiais.length;n++)if(e.materiais[n].id==t.id){e.materiais.splice(n,1);break}e.data_loaded=!0,Materialize.toast("Arquivo deletado",3e3)}).catch(function(t){console.log(t.data)})},e.openModalDeleteMaterial=function(t){e.modalContent=t,$("#modal-deleta-material").openModal()},r()}]),oddin.controller("NoticesController",["$scope","$stateParams","InstructionAPI","CurrentUser",function(t,e,a,n){function o(){a.show(e.disciplinaID).then(function(e){t.disciplina=e.data}).catch(function(t){console.log(t.data)})}t.usuario=n,t.data_loaded=!0,t.buscaAvisos=function(){a.getNotices(e.disciplinaID).then(function(e){t.avisos=e.data}).catch(function(t){console.log(t.data)})},t.postaAviso=function(n){var o=angular.copy(n);delete t.aviso,t.data_loaded=!1,a.createNotice(e.disciplinaID,o).then(function(e){t.avisos.push(e.data),t.data_loaded=!0,Materialize.toast("Aviso postado",4e3)}).catch(function(t){console.log(t.data)})},o()}]),oddin.controller("ParticipantsController",["$scope","$stateParams","InstructionAPI","CurrentUser",function(t,e,a,n){function o(){a.show(e.disciplinaID).then(function(e){t.disciplina=e.data}).catch(function(t){console.log(t.data)})}t.usuario=n,t.data_loaded=!0,t.buscaParticipantes=function(){a.getParticipants(e.disciplinaID).then(function(e){t.participantes=e.data}).catch(function(t){console.log(t.data)})},o()}]),oddin.controller("PresentationMaterialController",["$scope","$stateParams","$http","CurrentUser","PresentationAPI","MaterialAPI",function(t,e,a,n,o,i){function r(){o.show(e.aulaID).then(function(e){t.aula=e.data}).catch(function(t){console.log(t.data)})}function s(t){newMaterial=t.data,file=document.forms.uploadArchive.file.files[0],fd=new FormData;for(var e in newMaterial.fields)fd.append(e,newMaterial.fields[e]);return fd.append("file",file),a.post(newMaterial.url,fd,{headers:{"Content-Type":void 0}})}function d(){return i.update(newMaterial.id,{name:file.name,mime:file.type})}function l(e){t.materiais.push(e.data.material),t.data_loaded=!0,document.getElementById("material-file").value="",document.getElementById("material-description").value="",Materialize.toast("O arquivo "+file.name+" foi postado",3e3)}t.usuario=n,t.data_loaded=!0,t.buscaMateriais=function(){o.getMaterials(e.aulaID).then(function(e){t.materiais=e.data}).catch(function(t){console.log(t.data)})},t.uploadMaterial=function(){t.data_loaded=!1,o.createMaterial(e.aulaID).then(s).then(d).then(l).catch(function(t){console.log(t.data)})},t.downloadMaterial=function(e){t.data_loaded=!1,i.show(e.id).then(function(a){var n=document.createElement("a");n.setAttribute("href",a.data.url),n.setAttribute("download",!0),hiddenLink=document.getElementById("hidden-link"),hiddenLink.appendChild(n),n.click(),t.data_loaded=!0,Materialize.toast("Fazendo download de "+e.name,4e3),hiddenLink.removeChild(n)}).catch(function(t){console.log(t.data)})},t.deleteMaterial=function(e){t.data_loaded=!1,i.destroy(e.id).then(function(a){for(var n=0;n<t.materiais.length;n++)if(t.materiais[n].id==e.id){t.materiais.splice(n,1);break}t.data_loaded=!0,Materialize.toast("Arquivo deletado",3e3)}).catch(function(t){console.log(t.data)})},t.openModalDeleteMaterial=function(e){t.modalContent=e,$("#modal-deleta-material").openModal()},r()}]),oddin.controller("PresentationsController",["$scope","$stateParams","InstructionAPI","PresentationAPI","CurrentUser",function(t,e,a,n,o){function i(){a.show(e.disciplinaID).then(function(e){t.disciplina=e.data}).catch(function(t){console.log(t.data)})}t.usuario=o,t.data_loaded=!0,t.buscaAulas=function(){a.getPresentations(e.disciplinaID).then(function(e){t.aulas=e.data}).catch(function(t){console.log(t.data)})},t.criaAula=function(n){var o=angular.copy(n);delete t.aula,t.data_loaded=!1,a.createPresentation(e.disciplinaID,o).then(function(e){t.aulas.push(e.data),t.data_loaded=!0,Materialize.toast("A aula "+e.data.subject+" foi criada",4e3)}).catch(function(t){Materialize.toast("Não foi possível criar uma nova aula",3e3)})},t.fechaAula=function(e){t.data_loaded=!1;var a=t.aulas.indexOf(e);n.close(e.id).then(function(n){t.aulas[a]=n.data,t.data_loaded=!0,Materialize.toast("A aula "+e.subject+" foi finalizada",3e3)}).catch(function(t){console.log(t.data)})},t.openModalCloseLecture=function(e){t.modalContent=e,$("#modal-fecha-aula").openModal()},i()}]),oddin.controller("PresentationShowController",["$scope","$stateParams","PresentationAPI","QuestionAPI","AnswerAPI","CurrentUser",function(t,e,a,n,o,i){function r(){a.show(e.aulaID).then(function(e){t.aula=e.data}).catch(function(t){console.log(t.data)})}function s(e){d[e.id]=e,t.duvidas.unshift(e),t.duvida=new Duvida}t.usuario=i,t.filter=!1,t.last_doubt={},t.data_loaded=!0;const d={},l=io.connect("http://socket-oddin.rhcloud.com:8000/presentation");t.buscaDuvidas=function(){a.getQuestions(e.aulaID).then(function(e){t.duvidas=e.data}).catch(function(t){console.log(t.data)})},t.postaDuvida=function(n){t.data_loaded=!1;var o=angular.copy(n);delete t.duvida,void 0===o.anonymous&&(o.anonymous=!1),a.createQuestion(e.aulaID,o).then(function(e){l.emit("POST /questions",[e.data]),t.data_loaded=!0,Materialize.toast("Dúvida postada",3e3)}).catch(function(t){console.log(t.data)})},t.enableFilter=function(){t.filter=!0,$("#post-order").removeClass("filter-item-active"),$("#ranking-order").addClass("filter-item-active")},t.disableFilter=function(){t.filter=!1,$("#ranking-order").removeClass("filter-item-active"),$("#post-order").addClass("filter-item-active")},t.setLastDoubt=function(e){t.last_doubt=e},t.fecharRespostas=function(t){t.answers=void 0},t.buscaRespostas=function(t){n.getAnswers(t.id).then(function(e){t.answers=e.data}).catch(function(t){console.log(t.data)})},t.postaResposta=function(e){t.data_loaded=!1;var a=angular.copy(e);delete t.resposta,n.createAnswer(t.last_doubt.id,a).then(function(e){t.last_doubt.has_answer=!0,t.data_loaded=!0,Materialize.toast("Resposta postada",1e3),t.buscaRespostas(t.last_doubt),t.resposta.text=""}).catch(function(t){console.log(t.data)})},t.upvoteDuvida=function(t){n.upvote(t.id).then(function(){t.upvotes++,t.my_vote=1}).catch(function(t){console.log(t.data)})},t.cancelVoteDuvida=function(t){n.destroyVote(t.id).then(function(){t.upvotes--,t.my_vote=0}).catch(function(t){console.log(t.data)})},t.upvoteResposta=function(t){o.upvote(t.id).then(function(){0==t.my_vote?t.upvotes++:t.my_vote==-1&&(t.upvotes+=2),t.my_vote=1}).catch(function(t){console.log(t.data)})},t.downvoteResposta=function(t){o.downvote(t.id).then(function(){0==t.my_vote?t.upvotes--:1==t.my_vote&&(t.upvotes-=2),t.my_vote=-1}).catch(function(t){console.log(t.data)})},t.cancelVoteResposta=function(t){o.destroyVote(t.id).then(function(){1==t.my_vote?t.upvotes--:t.upvotes++,t.my_vote=0}).catch(function(t){console.log(t.data)})},t.aceitaResposta=function(e){o.accept(e.id).then(function(){e.accepted=!0,t.duvidas.forEach(function(t){t.id===e.question.id&&(t.answered=!0)})}).catch(function(t){console.log(t.data)})},t.recusaResposta=function(e){o.reject(e.id).then(function(){e.accepted=!1,t.duvidas.forEach(function(t){t.id===e.question.id&&(t.answered=!1)})}).catch(function(t){console.log(t.data)})},l.on("POST /questions",function(e){t.$apply(function(){e.forEach(function(t){s(t)})})}),r()}]),oddin.controller("SurveysController",["$scope","$cookies","$stateParams","InstructionAPI","SurveyAPI","AlternativeAPI","CurrentUser",function(t,e,a,n,o,i,r){!function(){n.show(a.disciplinaID).then(function(e){t.disciplina=e.data}).catch(function(t){console.log(t.data)})}(),t.usuario=r,t.data_loaded=!0,t.survey={alternatives:[{}]},t.buscaEnquetes=function(){n.getSurveys(a.disciplinaID).then(function(e){t.surveys=e.data}).catch(function(t){console.log(t.data)})},t.createSurvey=function(e){t.data_loaded=!1,n.createSurvey(a.disciplinaID,e).then(function(e){t.surveys.push(e.data),t.survey={alternatives:[{}]},t.data_loaded=!0,Materialize.toast("Enquete criada com sucesso",3e3)}).catch(function(t){console.log(t.data)})},t.updateSurvey=function(e){t.data_loaded=!1;var a=angular.copy(e);delete t.modalContent,o.update(a.id,a).then(function(e){for(var n=0;n<t.surveys.length;n++)if(t.surveys[n].id==a.id){t.surveys[n]=e.data;break}t.data_loaded=!0,Materialize.toast("Enquete atualizada com sucesso",3e3)}).catch(function(t){console.log(t.data)})},t.deleteSurvey=function(e){t.data_loaded=!1,o.destroy(e.id).then(function(){for(var a=0;a<t.surveys.length;a++)if(t.surveys[a].id==e.id){t.surveys.splice(a,1);break}t.data_loaded=!0,Materialize.toast("Enquete excluída com sucesso",3e3)}).catch(function(t){console.log(t.data)})},t.closeSurvey=function(e){t.data_loaded=!1,o.close(e.id).then(function(a){for(var n=0;n<t.surveys.length;n++)if(t.surveys[n].id==e.id){t.surveys[n]=a.data;break}t.data_loaded=!0,Materialize.toast("Enquete encerrada com sucesso",3e3)}).catch(function(t){console.log(t.data)})},t.makeChoice=function(e){return e.choice?(t.data_loaded=!1,void i.choose(e.choice).then(function(a){for(var n=0;n<t.surveys.length;n++)if(t.surveys[n].id==e.id){t.surveys[n]=a.data;break}t.data_loaded=!0,Materialize.toast("Voto realizado com sucesso",3e3)}).catch(function(t){console.log(t.data)})):void Materialize.toast("Você deve selecionar uma alternativa antes de votar",3e3)},t.displayAnswers=function(t){"none"==$("#answers-"+t.id).css("display")?$("#answers-"+t.id).css("display","block"):$("#answers-"+t.id).css("display","none")},t.displayButton=function(t){return"none"==$("#answers-"+t.id).css("display")?0==e.get("profile")?"Ver Alternativas":"Ver Resultado":0==e.get("profile")?"Ocultar Alternativas":"Ocultar Resultado"},t.addNewAlternative=function(){t.survey.alternatives.push({})},t.removeAlternative=function(){var e=t.survey.alternatives.length-1;t.survey.alternatives.splice(e)},t.openModalDeleteSurvey=function(e){t.modalContent=angular.copy(e),$("#delete-enquete").openModal()},t.openModalCloseSurvey=function(e){t.modalContent=angular.copy(e),$("#close-enquete").openModal()},t.openModalEditSurvey=function(e){t.modalContent=angular.copy(e),$("#edit-enquete").openModal()}}]),oddin.controller("WorksController",["$http","$scope","$stateParams","$filter","InstructionAPI","WorkAPI","MaterialAPI","CurrentUser","$filter","$q",function(t,e,a,n,o,i,r,s,n,d){function l(){o.show(a.disciplinaID).then(function(t){e.disciplina=t.data}).catch(function(t){console.log(t.data)})}function c(t){currentWork=t.data;var e=d.defer();return e.resolve(),e.promise}function u(){return r.destroy(currentWork.materials[0].id)}function f(){return i.createMaterial(currentWork.id)}function p(e){newMaterial=e.data,file=document.forms.uploadArchive.file.files[0],fd=new FormData;for(var a in newMaterial.fields)fd.append(a,newMaterial.fields[a]);return fd.append("file",file),t.post(newMaterial.url,fd,{headers:{"Content-Type":void 0}})}function h(e){newMaterial=e.data,file=document.forms.updateArchive.file.files[0],fd=new FormData;for(var a in newMaterial.fields)fd.append(a,newMaterial.fields[a]);return fd.append("file",file),t.post(newMaterial.url,fd,{headers:{"Content-Type":void 0}})}function m(){return r.update(newMaterial.id,{name:file.name,mime:file.type})}function v(){return i.show(currentWork.id)}function g(t){e.tarefas.push(t.data),e.data_loaded=!0,Materialize.toast("A tarefa foi criada",3e3)}function y(t){for(var a=0;a<e.tarefas.length;a++)if(e.tarefas[a].id==t.data.id){e.tarefas[a]=t.data;break}e.data_loaded=!0,Materialize.toast("A tarefa foi atualizada",3e3)}e.usuario=s,e.data_loaded=!0,e.buscaTarefas=function(){o.getWorks(a.disciplinaID).then(function(t){e.tarefas=t.data}).catch(function(t){console.log(t.data)})},e.criaTarefa=function(t){e.data_loaded=!1;var i=angular.copy(t);return delete e.tarefa,i.deadline=n("toDate")(i.deadline),document.forms.uploadArchive.file.files[0]?void o.createWork(a.disciplinaID,i).then(c).then(f).then(p).then(m).then(v).then(g).catch(function(t){console.log(t.data)}):void o.createWork(a.disciplinaID,i).then(g).catch(function(t){console.log(t.data)})},e.atualizaTarefa=function(t){e.data_loaded=!1;var a=angular.copy(t);return delete e.modalContent,a.deadline=n("toDate")(a.deadline),a.materials.length>0&&document.forms.updateArchive.file.files[0]?void i.update(a.id,a).then(c).then(u).then(f).then(h).then(m).then(v).then(y).catch(function(t){console.log(t.data)}):a.materials.length>0&&!document.forms.updateArchive.file.files[0]?void i.update(a.id,a).then(c).then(u).then(v).then(y).catch(function(t){console.log(t.data)}):0==a.materials.length&&document.forms.updateArchive.file.files[0]?void i.update(a.id,a).then(c).then(f).then(h).then(m).then(v).then(y).catch(function(t){console.log(t.data)}):void i.update(a.id,a).then(y).catch(function(t){console.log(t.data)})},e.deletaTarefa=function(t){e.data_loaded=!1,i.destroy(t.id).then(function(){if(t.materials.length>0)return void r.destroy(t.materials[0].id).then(function(){for(var a=0;a<e.tarefas.length;a++)if(e.tarefas[a].id==t.id){e.tarefas.splice(a,1);break}e.data_loaded=!0,Materialize.toast("Tarefa deletada",3e3)});
for(var a=0;a<e.tarefas.length;a++)if(e.tarefas[a].id==t.id){e.tarefas.splice(a,1);break}e.data_loaded=!0,Materialize.toast("Tarefa deletada",3e3)})},e.downloadEspecificacao=function(t){e.data_loaded=!1,r.show(t.materials[0].id).then(function(a){var n=document.createElement("a");n.setAttribute("href",a.data.url),n.setAttribute("download",!0),hiddenLink=document.getElementById("hidden-link"),hiddenLink.appendChild(n),n.click(),e.data_loaded=!0,Materialize.toast("Baixando especificação: "+t.materials[0].name,3e3),hiddenLink.removeChild(n)}).catch(function(t){console.log(t.data)})},e.openModalEditWork=function(t){e.modalContent=angular.copy(t),e.modalContent.deadline=n("date")(e.modalContent.deadline,"ddMMyyyy"),t.materials[0]&&(e.modalContent.materialName=t.materials[0].name),$("#editar-tarefa").openModal()},e.openModalDeleteWork=function(t){e.modalContent=t,$("#modal-deleta-tarefa").openModal()},l()}]),oddin.controller("WorkShowController",["$scope","$stateParams","$http","CurrentUser","WorkAPI","MaterialAPI","SubmissionAPI","$q",function(t,e,a,n,o,i,r,s){function d(){o.show(e.tarefaID).then(function(e){t.tarefa=e.data}).catch(function(t){console.log(t.data)})}function l(t){currentSubmission=t.data;var e=s.defer();return e.resolve(),e.promise}function c(){return i.destroy(currentSubmission.materials[0].id)}function u(){return r.createMaterial(currentSubmission.id)}function f(t){newMaterial=t.data,file=document.forms.uploadArchive.file.files[0],fd=new FormData;for(var e in newMaterial.fields)fd.append(e,newMaterial.fields[e]);return fd.append("file",file),a.post(newMaterial.url,fd,{headers:{"Content-Type":void 0}})}function p(t){newMaterial=t.data,file=document.forms.updateArchive.file.files[0],fd=new FormData;for(var e in newMaterial.fields)fd.append(e,newMaterial.fields[e]);return fd.append("file",file),a.post(newMaterial.url,fd,{headers:{"Content-Type":void 0}})}function h(){return i.update(newMaterial.id,{name:file.name,mime:file.type})}function m(){return r.show(currentSubmission.id)}function v(e){t.submissoes.push(e.data),t.data_loaded=!0,Materialize.toast("Trabalho postado",3e3)}function g(e){for(var a=0;a<t.submissoes.length;a++)if(t.submissoes[a].id==e.data.id){t.submissoes[a]=e.data;break}t.data_loaded=!0,Materialize.toast("O trabalho foi atualizado",3e3)}t.data_loaded=!0,t.usuario=n,t.buscaSubmissoesAluno=function(){o.getSubmissions(e.tarefaID).then(function(e){t.submissoes=[];var a=e.data;a.forEach(function(e){e.person.id==t.usuario.id&&t.submissoes.push(e)})}).catch(function(t){console.log(t.data)})},t.buscaSubmissoes=function(){o.getSubmissions(e.tarefaID).then(function(e){t.submissoes=e.data}).catch(function(t){console.log(t.data)})},t.deleteSubmission=function(e){t.data_loaded=!1,r.destroy(e.id).then(function(){if(e.materials.length>0)i.destroy(e.materials[0].id).then(function(){for(var a=0;a<t.submissoes.length;a++)if(t.submissoes[a].id===e.id){t.submissoes.splice(a,1);break}t.data_loaded=!0,Materialize.toast("Trabalho deletado",3e3)});else{for(var a=0;a<t.submissoes.length;a++)if(t.submissoes[a].id===e.id){t.submissoes.splice(a,1);break}t.data_loaded=!0,Materialize.toast("Trabalho deletado",3e3)}}).catch(function(t){console.log(t.data)})},t.createSubmission=function(a){t.data_loaded=!1;var n=angular.copy(a);return delete t.submission,document.forms.uploadArchive.file.files[0]?void o.createSubmission(e.tarefaID,n).then(l).then(u).then(f).then(h).then(m).then(v).catch(function(t){console.log(t.data)}):void o.createSubmission(e.tarefaID,n).then(v).catch(function(t){console.log(t.data)})},t.updateSubmission=function(e){t.data_loaded=!1;var a=angular.copy(e);return delete t.modalContent,a.materials.length>0&&document.forms.updateArchive.file.files[0]?void r.update(a.id,a).then(l).then(c).then(u).then(p).then(h).then(m).then(g).catch(function(t){console.log(t.data)}):a.materials.length>0&&!document.forms.updateArchive.file.files[0]?void r.update(a.id,a).then(l).then(c).then(m).then(g).catch(function(t){console.log(t.data)}):0==a.materials.length&&document.forms.updateArchive.file.files[0]?void r.update(a.id,a).then(l).then(u).then(p).then(h).then(m).then(g).catch(function(t){console.log(t.data)}):void r.update(a.id,a).then(g).catch(function(t){console.log(t.data)})},t.downloadSubmission=function(e){t.data_loaded=!1,i.show(e.materials[0].id).then(function(a){var n=document.createElement("a");n.setAttribute("href",a.data.url),n.setAttribute("download",!0),hiddenLink=document.getElementById("hidden-link"),hiddenLink.appendChild(n),n.click(),t.data_loaded=!0,Materialize.toast("Baixando trabalho: "+e.materials[0].name,3e3),hiddenLink.removeChild(n)}).catch(function(t){console.log(t.data)})},t.openModalDeleteSubmission=function(e){t.modalContent=e,$("#modal-deleta-submissao").openModal()},t.openModalEditSubmission=function(e){t.modalContent=angular.copy(e),e.materials[0]&&(t.modalContent.materialName=e.materials[0].name),$("#editar-trabalho").openModal()},d()}]),oddin.directive("oddinFab",function(){return{replace:!0,restrict:"AE",scope:{trigger:"@",modalTrigger:"@",icon:"@"},templateUrl:"/components/fab"}}),oddin.directive("oddinHeader",function(){return{templateUrl:"/components/header",replace:!0,restrict:"AE",scope:{title:"@",btnType:"@",toStateUrl:"@",logo:"@"}}}),oddin.directive("oddinPreloader",function(){return{replace:!0,restrict:"AE",scope:{sideBar:"@",loadVar:"="},templateUrl:"/components/preloader"}}),oddin.filter("toDate",function(){return function(t,e){var a=parseInt(t.substring(0,2)),n=parseInt(t.substring(2,4))-1,o=parseInt(t.substring(4,8)),i=0,r=0;return e&&(i=parseInt(e.substring(0,2)),r=parseInt(e.substring(2,4))),new Date(o,n,a,i,r)}}),oddin.factory("AlternativeAPI",["$http",function(t){var e=function(e){return t.post("/api/alternatives/"+e+"/choose")};return{choose:e}}]),oddin.factory("AnswerAPI",["$http",function(t){var e=function(e){return t.post("/api/answers/"+e+"/upvote")},a=function(e){return t.post("/api/answers/"+e+"/downvote")},n=function(e){return t.delete("/api/answers/"+e+"/vote")},o=function(e){return t.post("/api/answers/"+e+"/accept")},i=function(e){return t.delete("/api/answers/"+e+"/accept")};return{upvote:e,downvote:a,destroyVote:n,accept:o,reject:i}}]),oddin.factory("CurrentUser",["$cookies",function(t){return{id:JSON.parse(t.get("session").substring(2)).person.id,name:JSON.parse(t.get("session").substring(2)).person.name,email:JSON.parse(t.get("session").substring(2)).person.email}}]),oddin.factory("DateAPI",["$http",function(t){var e=function(e,a){return t.put("/api/dates/"+e,a)},a=function(e){return t.delete("/api/dates/"+e)};return{update:e,destroy:a}}]),oddin.factory("EnrollAPI",["$http",function(t){var e=function(e){return t.post("/api/enrolls/",e)},a=function(e){return t.delete("/api/enrolls/"+e)};return{create:e,destroy:a}}]),oddin.factory("EventAPI",["$http",function(t){var e=function(){return t.get("/api/events/")},a=function(e){return t.get("/api/events/"+e)},n=function(e){return t.post("/api/events/",e)},o=function(e,a){return t.put("/api/events/"+e,a)},i=function(e){return t.delete("/api/events/"+e)},r=function(e){return t.get("/api/events/"+e+"/instructions")};return{index:e,show:a,create:n,update:o,destroy:i,getInstructions:r}}]),oddin.factory("FaqAPI",["$http",function(t){var e=function(e,a){return t.put("/api/faqs/"+e,a)},a=function(e){return t.delete("/api/faqs/"+e)};return{update:e,destroy:a}}]),oddin.factory("InstructionAPI",["$http",function(t){var e=function(){return t.get("/api/instructions/")},a=function(e){return t.get("/api/instructions/"+e)},n=function(e){return t.post("api/instructions",e)},o=function(e){return t.delete("api/instructions/"+e)},i=function(e){return t.get("/api/instructions/"+e+"/profile")},r=function(e){return t.get("/api/instructions/"+e+"/presentations")},s=function(e){return t.get("/api/instructions/"+e+"/notices")},d=function(e){return t.get("/api/instructions/"+e+"/dates")},l=function(e){return t.get("/api/instructions/"+e+"/works")},c=function(e){return t.get("/api/instructions/"+e+"/materials")},u=function(e){return t.get("/api/instructions/"+e+"/participants")},f=function(e){return t.get("/api/instructions/"+e+"/faqs")},p=function(e){return t.get("/api/instructions/"+e+"/surveys")},h=function(e,a){return t.post("/api/instructions/"+e+"/presentations",a)},m=function(e,a){return t.post("/api/instructions/"+e+"/notices",a)},v=function(e,a){return t.post("/api/instructions/"+e+"/dates",a)},g=function(e,a){return t.post("/api/instructions/"+e+"/works",a)},y=function(e){return t.post("/api/instructions/"+e+"/materials")},M=function(e,a){return t.post("/api/instructions/"+e+"/faqs",a)},I=function(e,a){return t.post("/api/instructions/"+e+"/surveys",a)};return{index:e,show:a,create:n,destroy:o,getProfile:i,getPresentations:r,getNotices:s,getDates:d,getWorks:l,getMaterials:c,getParticipants:u,getFAQs:f,getSurveys:p,createPresentation:h,createNotice:m,createDate:v,createWork:g,createMaterial:y,createFAQ:M,createSurvey:I}}]),oddin.factory("LectureAPI",["$http",function(t){var e=function(){return t.get("/api/lectures/")},a=function(e){return t.get("/api/lectures/"+e)},n=function(e){return t.post("/api/lectures/",e)},o=function(e,a){return t.put("/api/lectures/"+e,a)},i=function(e){return t.delete("/api/lectures/"+e)};return{index:e,show:a,create:n,update:o,destroy:i}}]),oddin.factory("LoginAPI",["$http",function(t){var e=function(e){return t.post("/login",e)},a=function(){return t.post("/logout")},n=function(e){return t.post("/recover-password",e)},o=function(e){return t.post("/redefine-password",e)};return{login:e,logout:a,recoverPassword:n,redefinePassword:o}}]),oddin.factory("ManageList",function(){var t=function(t,e){var a=t.findIndex(function(t){return t.id==e.id});t[a]=e},e=function(t,e){var a=t.findIndex(function(t){return t.id==e.id});t.splice(a,1)};return{updateItem:t,deleteItem:e}}),oddin.factory("MaterialAPI",["$http",function(t){var e=function(e){return t.get("/api/materials/"+e)},a=function(e,a){return t.put("/api/materials/"+e,a)},n=function(e){return t.delete("/api/materials/"+e)};return{show:e,update:a,destroy:n}}]),oddin.factory("PersonAPI",["$http",function(t){var e=function(){return t.get("/api/person/")},a=function(e){return t.get("/api/person/"+e)},n=function(e){return t.post("/api/person/",e)},o=function(e,a){return t.put("/api/person/"+e,a)},i=function(e){return t.delete("/api/person/"+e)};return{index:e,show:a,create:n,update:o,destroy:i}}]),oddin.factory("PresentationAPI",["$http",function(t){var e=function(e){return t.get("/api/presentations/"+e)},a=function(e){return t.post("/api/presentations/"+e+"/close")},n=function(e){return t.get("/api/presentation/"+e+"/materials")},o=function(e){return t.get("/api/presentations/"+e+"/questions")},i=function(e){return t.post("/api/presentation/"+e+"/materials")},r=function(e,a){return t.post("/api/presentations/"+e+"/questions",a)};return{show:e,close:a,getMaterials:n,getQuestions:o,createMaterial:i,createQuestion:r}}]),oddin.factory("QuestionAPI",["$http",function(t){var e=function(e){return t.get("/api/questions/"+e+"/answers")},a=function(e,a){return t.post("/api/questions/"+e+"/answers",a)},n=function(e){return t.post("/api/questions/"+e+"/upvote")},o=function(e){return t.delete("/api/questions/"+e+"/vote")};return{getAnswers:e,createAnswer:a,upvote:n,destroyVote:o}}]),oddin.factory("SubmissionAPI",["$http",function(t){var e=function(e){return t.get("/api/submissions/"+e)},a=function(e,a){return t.put("/api/submissions/"+e,a)},n=function(e){return t.delete("/api/submissions/"+e)},o=function(e){return t.post("/api/submissions/"+e+"/materials")};return{show:e,update:a,destroy:n,createMaterial:o}}]),oddin.factory("SurveyAPI",["$http",function(t){var e=function(e,a){return t.put("/api/surveys/"+e,a)},a=function(e){return t.delete("/api/surveys/"+e)},n=function(e){return t.post("/api/surveys/"+e+"/close")};return{update:e,destroy:a,close:n}}]),oddin.factory("WorkAPI",["$http",function(t){var e=function(e){return t.get("/api/works/"+e)},a=function(e,a){return t.put("/api/works/"+e,a)},n=function(e){return t.delete("/api/works/"+e)},o=function(e){return t.post("/api/works/"+e+"/materials")},i=function(e,a){return t.post("/api/works/"+e+"/submissions",a)},r=function(e){return t.get("/api/works/"+e+"/submissions")};return{show:e,update:a,destroy:n,createMaterial:o,createSubmission:i,getSubmissions:r}}]),window.onpopstate=function(){$(".lean-overlay").remove()};