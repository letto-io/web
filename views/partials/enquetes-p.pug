doctype html
header
	.navbar-fixed
		nav.navbar-fixed.barra-navegacao
			.nav-wrapper.barra-navegacao__container
				a.button-collapse.hide-on-large-only(href="" data-activates="slide-out", data-sidenav="left", data-closeonclick="true")
					i.material-icons menu
				a.barra-navegacao__voltar.hide-on-med-and-down(ui-sref='disciplinas')
					i.material-icons arrow_back
				h1.barra-navegacao__title.truncate {{disciplina.lecture.name}} - Enquetes
				a.brand-logo.right.hide-on-small-only(href="/")
					img.barra-navegacao__logo(src="/images/horizontal_logo.png")
	ul#slide-out.side-nav.fixed.barra-lateral
		.barra-lateral__header
			i.barra-lateral__user-avatar.material-icons account_circle
			p.barra-lateral__user-name {{usuario.name}}
			p.barra-lateral__user-email {{usuario.email}}
		li.no-padding
			ul.collapsible(data-collapsible="expandable")
				li.barra-lateral__item
					a.barra-lateral__item--collapsible.collapsible-header.active.truncate {{disciplina.lecture.name}}
					.collapsible-body
						ul
							li.barra-lateral__subitem
								a(ui-sref="aulas({disciplinaID: disciplina.id})") Aulas
							li.barra-lateral__subitem
								a(ui-sref="avisos({disciplinaID: disciplina.id})") Avisos
							li.barra-lateral__subitem
								a(ui-sref="datas({disciplinaID: disciplina.id})") Datas Importantes
							li.barra-lateral__subitem
								a(ui-sref="tarefas({disciplinaID: disciplina.id})") Tarefas
							li.barra-lateral__subitem
								a(ui-sref="materiais({disciplinaID: disciplina.id})") Material
							li.barra-lateral__subitem
								a(ui-sref="participantes({disciplinaID: disciplina.id})") Participantes
							li.barra-lateral__subitem
								a(ui-sref="faqs({disciplinaID: disciplina.id})") FAQs
							li.barra-lateral__subitem.active
								p Enquetes
		li.hide-on-large-only.no-padding.barra-lateral__item
			a(ui-sref='disciplinas') Disciplinas
		li.no-padding.barra-lateral__item(data-ng-controller="LoginController")
			a(href="" data-ng-click="logout()") Logout
main(data-ng-init="buscaEnquetes()")
	.preloader-wrapper.big.active.custom-preloader(ng-hide="data_loaded")
		.spinner-layer
			.circle-clipper.left
				.circle
	.container
		.fixed-action-btn(style="bottom: 24px; right: 24px;")
			a.btn-floating.btn-large.waves-effect.waves-light.modal-trigger(href="#criar-enquete", modal)
				i.large.material-icons add
		#delete-enquete.modal
			.modal-content
				h4.custom-modal__header Excluir Enquete
				p Tem certeza que deseja excluir '{{modalContent.title}}'?
			.modal-footer
				a(href='' data-ng-click="deleteSurvey(modalContent)").modal-action.modal-close.waves-effect.btn-flat.custom-modal__button Confirmar
				a(href='').modal-action.modal-close.waves-effect.btn-flat.custom-modal__button Cancelar
		#close-enquete.modal
			.modal-content
				h4.custom-modal__header Encerrar Enquete
				p Tem certeza que deseja encerrar '{{modalContent.title}}'?
			.modal-footer
				a(href='' data-ng-click="closeSurvey(modalContent)").modal-action.modal-close.waves-effect.btn-flat.custom-modal__button Confirmar
				a(href='').modal-action.modal-close.waves-effect.btn-flat.custom-modal__button Cancelar
		#edit-enquete.modal.bottom-sheet
			.modal-content.modal-criar-item
				.row
					form.offset-m2.offset-l3.col.s12.m8.l6(data-ng-submit="updateSurvey(modalContent)")
						h1.modal-criar-item__titulo Editar Enquete
						.row
							.input-field.col.s12
								input#survey_title(type="text", name="title", data-ng-model="modalContent.title" required)
								label(for="survey_title") Título
							.input-field.col.s12
								textarea#survey_question.materialize-textarea(name="question", data-ng-model="modalContent.question" required)
								label(for="faq_question") Pergunta
							.choices(data-ng-repeat="alternative in modalContent.alternatives")
								.input-field.col.s12.remove-choice-field
									input(data-ng-attr-id="alternative-{{modalContent.alternatives.indexOf(alternative)}}", type="text", name="alternative-{{modalContent.alternatives.indexOf(alternative)}}", data-ng-model="modalContent.alternatives[modalContent.alternatives.indexOf(alternative)].description" required)
									label(for="alternative-{{modalContent.alternatives.indexOf(alternative)}}") Alternativa {{modalContent.alternatives.indexOf(alternative) + 1}}
						button.btn.waves-effect.waves-light.modal-close(type="submit", name="action") Atualizar
		#criar-enquete.modal.bottom-sheet
			.modal-content.modal-criar-item
				.row
					form.offset-m2.offset-l3.col.s12.m8.l6(data-ng-submit="createSurvey(survey)")
						h1.modal-criar-item__titulo Criar Enquete
						.row
							.input-field.col.s12
								input#survey_title(type="text", name="title", data-ng-model="survey.title" required)
								label(for="survey_title") Título
							.input-field.col.s12
								textarea#survey_question.materialize-textarea(name="question", data-ng-model="survey.question" required)
								label(for="faq_question") Pergunta
							.choices(data-ng-repeat="alternative in survey.alternatives")
								.input-field.col.s11.remove-choice-field
									input(id="alternative-{{survey.alternatives.indexOf(alternative)}}", type="text", name="alternative-{{survey.alternatives.indexOf(alternative)}}", data-ng-model="survey.alternatives[survey.alternatives.indexOf(alternative)].description" required)
									label(for="alternative-{{survey.alternatives.indexOf(alternative)}}") Alternativa {{survey.alternatives.indexOf(alternative) + 1}}
								.input-field.col.s1.remove-choice-button(data-ng-show="$last")
									a.right(href='' data-ng-click="removeAlternative()")
										i.material-icons close
							.input-field.col.s12
								a.btn-floating.waves-effect.waves-light.right(data-ng-click="addNewAlternative()")
									i.material-icons add
						button.btn.waves-effect.waves-light.modal-close(type="submit", name="action") Enviar
		.card.pergunta(data-ng-repeat="survey in surveys")
			.card-content
				.custom-card__header
					span.title {{survey.title}}
					span.secondary-info
						span.secondary-info--leading(data-ng-if="!survey.closed") {{survey.created_at | date:"dd/MM/yyyy"}}
						span.closed-tag(data-ng-if="survey.closed") Encerrada
					p.survey-question {{survey.question}}
			.card-action.custom-card__action
				.row
					.col.s12
						a(href='' data-ng-click="openModalDeleteSurvey(survey)")
							i.material-icons delete
						a(href='' data-ng-click="openModalEditSurvey(survey)")
							i.material-icons edit
						a(href='' data-ng-click="openModalCloseSurvey(survey)" data-ng-if="!survey.closed")
							i.material-icons close
						.ver-resposta--prof.survey-button-answer
							a.waves-effect.btn-flat(data-ng-click="displayAnswers(survey)")
								span {{displayButton(survey)}}
			.resposta.survey-answer-container(data-ng-attr-id="answers-{{survey.id}}")
				.resposta__content.survey-answer-content
					ul.collection.survey-answer-list
						li.collection-item(data-ng-repeat="alternative in survey.alternatives")
							| {{alternative.description}}
							span.new.badge(data-badge-caption="Votos") {{alternative.choice_count}}
